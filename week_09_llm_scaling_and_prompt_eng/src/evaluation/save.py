import pandas as pd 
from datetime import datetime
import os

def save_results(model_name, prompt_version, questions, answers, generated_text, predictions, correct_vec, output_file): 
    """
    Saves model evaluation results to a CSV file.

    Creates a DataFrame containing the model's predictions, evaluation metadata, and correctness indicators,
    and saves it to the specified output path.

    Args:
        model_name (str): Name of the model used for generation.
        prompt_version (str): Identifier for the prompt version used.
        questions (list of str): List of input questions.
        answers (list of str): List of expected answers (ground truth).
        generated_text (list of str): Raw text generated by the model.
        predictions (list): Parsed model predictions (e.g., numeric values).
        correct_vec (list of int): Binary list indicating if each prediction was correct (1) or not (0).
        output_file (str): File path where the CSV results will be saved.

    Returns:
        None
    """
    result = pd.DataFrame({
        'example_id': [f'{i:04d}' for i in range(len(questions))], 
        'question': questions, 
        'expected_answer': answers, 
        'generated_text': generated_text,
        'model_prediction': predictions, 
        'is_correct': correct_vec, 
        'model_name': [model_name] * len(questions), 
        'prompt_version': [prompt_version] * len(questions), 
        'timestamp': [datetime.now().isoformat()] * len(questions)
    })

    os.makedirs(os.path.dirname(output_file), exist_ok = True) 
    result.to_csv(output_file, header = True, index = False) 

    